<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Protein Modeling - PLANT 2030</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #24292f;
  background-color: #f6f8fa;
}
pre.rouge .k, pre.rouge .kd, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kt, pre.rouge .kv {
  color: #cf222e;
}
pre.rouge .gr {
  color: #f6f8fa;
}
pre.rouge .gd {
  color: #82071e;
  background-color: #ffebe9;
}
pre.rouge .nb {
  color: #953800;
}
pre.rouge .nc {
  color: #953800;
}
pre.rouge .no {
  color: #953800;
}
pre.rouge .nn {
  color: #953800;
}
pre.rouge .sr {
  color: #116329;
}
pre.rouge .na {
  color: #116329;
}
pre.rouge .nt {
  color: #116329;
}
pre.rouge .gi {
  color: #116329;
  background-color: #dafbe1;
}
pre.rouge .kc {
  color: #0550ae;
}
pre.rouge .l, pre.rouge .ld, pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #0550ae;
}
pre.rouge .sb {
  color: #0550ae;
}
pre.rouge .bp {
  color: #0550ae;
}
pre.rouge .ne {
  color: #0550ae;
}
pre.rouge .nl {
  color: #0550ae;
}
pre.rouge .py {
  color: #0550ae;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi, pre.rouge .vm {
  color: #0550ae;
}
pre.rouge .o, pre.rouge .ow {
  color: #0550ae;
}
pre.rouge .gh {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .gu {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .se, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1, pre.rouge .ss {
  color: #0a3069;
}
pre.rouge .nd {
  color: #8250df;
}
pre.rouge .nf, pre.rouge .fm {
  color: #8250df;
}
pre.rouge .err {
  color: #f6f8fa;
  background-color: #82071e;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cp, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #6e7781;
}
pre.rouge .gl {
  color: #6e7781;
}
pre.rouge .gt {
  color: #6e7781;
}
pre.rouge .ni {
  color: #24292f;
}
pre.rouge .si {
  color: #24292f;
}
pre.rouge .ge {
  color: #24292f;
  font-style: italic;
}
pre.rouge .gs {
  color: #24292f;
  font-weight: bold;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Protein Modeling - PLANT 2030</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_prediction_with_alphafold3">Prediction with AlphaFold3</a></li>
<li><a href="#_analyzing_the_structures_with_pymol">Analyzing the structures with PyMOL</a>
<ul class="sectlevel2">
<li><a href="#_loading_a_structure">Loading a structure</a></li>
<li><a href="#_different_representations">Different representations</a></li>
<li><a href="#_coloring_and_apbs">Coloring and APBS</a></li>
</ul>
</li>
<li><a href="#_first_selections">First selections</a></li>
<li><a href="#_ramachandran">Ramachandran</a></li>
<li><a href="#_contact_matrix">Contact matrix</a></li>
<li><a href="#_structural_superposition">Structural superposition</a></li>
<li><a href="#_rendering_a_figure">Rendering a figure</a></li>
<li><a href="#_save">Save</a></li>
<li><a href="#_fun_exercises">Fun exercises</a>
<ul class="sectlevel2">
<li><a href="#_identify_anfinsens_cysteines">Identify Anfinsen&#8217;s cysteines</a></li>
<li><a href="#_check_the_surface_charge_distribution_of_a_single_alpha_helix">Check the surface charge distribution of a single alpha helix</a></li>
<li><a href="#_try_different_phi_and_psi_angles">Try different phi and psi angles</a></li>
<li><a href="#_check_models_1_4">Check models 1-4</a></li>
<li><a href="#_predict_another_mate_example">Predict another MATE example</a></li>
<li><a href="#_find_local_regions_with_optimal_superposition">Find local regions with optimal superposition</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_prediction_with_alphafold3">Prediction with AlphaFold3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Predicting with <a href="https://www.nature.com/articles/s41586-024-07487-w">AlphaFold3</a> could not be easier.
In <a href="https://alphafoldserver.com/">AlphaFold3 server</a> paste the sequence of the protein to be modeled, as well as further information on other entities to be predicted together.
If you prefer to use IPK&#8217;s local installation of AlphaFold2 in the future, please check our <a href="https://github.com/amandascamara/Protein-Structure-Workshop">other tutorial</a> on the topic.
In this tutorial we will predict the structure of a Multi-drug Resistance Transporter protein (MATE). Proteins of this family sense changes in one side of the membrane, like increased acidity in the soil, and transport one molecule from the other side of the membrane as a response. Our MATE example from barley has the sequence below. Used to make a prediction of its structure with AlphaFold3</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>&gt;MATE_example
MAATSPAPTRAAAALTLAPNRRVHHVHMPSSRPCPCRASAAPRRRTPRCRAKPTVKGVVDDDEDASRESEPEMKEEEAMASMGTLPGWLRLDTVGMDILSIAAPAVLALAADPIAALVDTAFVGHIGSTELAAVGVSISIFNLVSKLFNVPLLNVTTSFVAEQQAVDDGYRRTGENEFRRSPDKLTEERKFLPAVTTSLALASGIGLMETVALIFGSGTLMDVIGIPVDSPVRIPAEQFLAFRAYGAPPIIVALAAQGAFRGLMDTKTPLYAIGVGNLVNAILDAIFVFPLGLGVRGAALATVTSEYVIACILLWKLNSKVVIFSGKIIAGGVIRYLKSGGLLIGRTIAVLLTMTLSTSLAAKEGAIPMAGHQLCLQVWLTISLLNDALALAGQALLATEYTKRNYKQSRIVLYRVLQIGGATGMALAIILLFGFESFSLLFTDDPAVLAIAKSGVWFVAISQPINAVAFVIDGLYYGVSDFAYAAYSMFFAGAISSAFLLVAAPQFGLGGVWAGLILFMSLRAVAGLWRLGSKGGPWNLILSETDLRDKM</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a few minutes, AlphaFold3 outputs a structure prediction.
Looking at it, can you recognize how this protein is set in the membrane? Which part face the lipids of the membrane, which parts face the inside or the outside of the cell, and where is the channel pore? Just make a guess and we will check for more evidences during this tutorial.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure1.png" alt="Figure1" width="500">
</div>
</div>
<div class="paragraph">
<p>AlphaFold3 outputs 3 main pieces of information: the structure (colored by predicted <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3799472/">Local Distance Difference Test</a> - plDDT),
the Predicted Aligned Error (PAE) and predicted <a href="https://en.wikipedia.org/wiki/Template_modeling_score">Template Modeling</a> scores for the entire protein complex (pTM) and for the residues in the interface between subnunits (ipTM), for predictions with multiple chains.</p>
</div>
<div class="paragraph">
<p>The plDDT and pTM values derive from usual comparison measurements between two protein structures (lDDT and TM). But the 'predicted' term indicates the models are compared with the ground truth.
PAE was introduced with AlphaFold2 and gives the error distance of residue x if the predicted and 'true' structures were aligned at residue y (an asymmetric matrix).
It measures the relative position between two residues.
Moreover, it reflects the relative position of domains.
In some cases, the structure of different domains is well predicted, but not their relative position,
and this appears in the PAE, as explained in the section 'How to interpret the Predicted Aligned Error' present in every entry of <a href="https://alphafold.ebi.ac.uk/">AlphaFold Protein Structure Database</a>, like in this <a href="https://alphafold.ebi.ac.uk/entry/Q9Y223#help">example</a>.</p>
</div>
<div class="paragraph">
<p>Downloading the results, you will get the following files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="k">*</span>_full_data_?.json <i class="conum" data-value="1"></i><b>(1)</b>
<span class="k">*</span>_job_Request.json <i class="conum" data-value="2"></i><b>(2)</b>
<span class="k">*</span>_model_?.cif <i class="conum" data-value="3"></i><b>(3)</b>
<span class="k">*</span>_summary_confidences_?.json <i class="conum" data-value="4"></i><b>(4)</b>
terms_of_use.md <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>All files can be read with text editors.</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For each output model, a file with lists that correspond to the chain ID and plDDT of each atom, PAE, chain ID and residue number for each residue.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The input information given by the user and the seed used, so that the same prediction can be done again.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>These are the most expected files - five structure files, globally ranked by a mixture of pTM, ipTM, amount of disorder and clashes (model_0 has the best score).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>For each output model, a file with lists of pTM, ipTM and PAE for the chains, plus the fraction of disorder (here defined as above a threshold of relative solvent accessible surface area), the existence of clashes and the number of recycles used to determine the protein structure as in AlphaFold2.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Terms of use from Google, which you agree upon running the prediction with a google account.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>More about the output can be found on the <a href="https://github.com/google-deepmind/alphafold3/">github of AlphaFold3</a> and on the paper&#8217;s <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-024-07487-w/MediaObjects/41586_2024_7487_MOESM1_ESM.pdf">supplementary material</a> .
Compared to the output of AlphaFold2, this output is summarized.
Main missing information is the verbose on the prediction steps and the multiple sequence alignments, which are substantially reduced and de-emphasized in the new pipeline, which rather compares sequence pairs.
It also explicitly outputs a value for disorder based on Relative solvent Accessible Surface Area (RASA) metrics, not relying on plDDT anymore.
It also ceased to output timings on the steps of the prediction, as AlphaFold2 did, but it is much faster.</p>
</div>
<div class="paragraph">
<p>The .cif structure files (an updated version of the old .pdb format) can be read with text editors. .cif files usually have a header with information on the source of the file,
 with metrics from the experiment used to solve this structure (in this case some details about AlphaFold3),
 some metrics on the molecules, and, most important, the atomic coordinates together with plDDT values for each atom (AlphaFold2 output only the confidence per residue).</p>
</div>
<div class="paragraph">
<p>Create a folder where you have your AlphaFold predictions and the scripts for this workshop, which can be downloaded from <a href="https://github.com/InsilicoGenebankProteomics/ProteinModeling-Plant2020SpringSchool">our GitHub page</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analyzing_the_structures_with_pymol">Analyzing the structures with PyMOL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Structure files can also be opened with programs for visualizing molecules.
We are going to use PyMOL, a molecular visualization program written in Python, hence the 'Py' suffix.
It was released for the first time in 2000 as an open source and free software by DeLano Scientific LLC with a vision of open science.
Since 2010 it is commercialized by Schrödinger, Inc. and some of the source code are no longer released.
PyMOL can be downloaded in <a href="https://www.pymol.org/">Schrödinger’s webpage</a>, including its source code.
It also has a <a href="https://pymolwiki.org/index.php/Main_Page">wiki page</a> very useful, full of examples and tutorials.
Alternative programs are Chimera, RasMOL, VMD (specially useful for molecular dynamics) and Coot (specially useful for building and validating models with crystallographic data).</p>
</div>
<div class="paragraph">
<p>PyMOL works both with graphical interface and command line.</p>
</div>
<div class="paragraph">
<div class="title">PyMOL interface</div>
<p><span class="image"><img src="Figures/Figure2.png" alt="Figure2"></span></p>
</div>
<div class="paragraph">
<p>Those many options allow different ways of working with molecules to do similar things.
Throughout this tutorial we will show both ways, mouse actions and command lines, whenever possible.
Mouse actions will start with # and will be colored in <span class="olive">olive</span>.
Command lines will follow &gt; and will be highlighted as Python codes.</p>
</div>
<div class="sect2">
<h3 id="_loading_a_structure">Loading a structure</h3>
<div class="paragraph">
<p>We can open a structure file in different ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Open... -&gt; ... select downloaded AlphaFold3 model file
</span><span class="o">&gt;</span>
<span class="n">pwd</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="n">cd</span> <span class="o">/</span><span class="n">path2file</span><span class="o">/</span>
<span class="n">ls</span>
<span class="n">load</span> <span class="o">/</span><span class="n">path2file</span><span class="o">/</span><span class="n">model_0</span><span class="p">.</span><span class="n">cif</span>
<span class="n">set_name</span> <span class="n">complicated_original_file_name</span><span class="p">,</span> <span class="n">model_0</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Some shell commands work in the command area of PyMOL as well. pwd (Print Working Directory) prints the current directory, cd (Change Directory) navigates to a new directory, and ls lists all the files in the current directory. Try navigating to the folder you created and load a predicted model.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You can rename this object inside PyMOL if the uploaded file had a complicated name from AlphaFold output.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Or just drag the file from its folder to PyMOL interface.
After uploaded, the structure will appear as a new object at the sidebar with the name of the file without the .cif extension.</p>
</div>
<div class="paragraph">
<div class="title">List of objects</div>
<p><span class="image"><img src="Figures/Figure3.png" alt="Figure3" width="200"></span></p>
</div>
<div class="paragraph">
<p>Use the mouse in the 3-Button Viewing mode to rotate the uploaded molecules.
Click the right button and move to zoom in and out.
Ctrl (or strg in German or command on Mac) + mouse left button to move the object on the image plane.
Other mouse functions together with keyboard shortcuts are possible, but they vary with mouse type.
Careful not to change to the 3-Button Editing mode of the mouse, or you may edit the structure accidentally!</p>
</div>
</div>
<div class="sect2">
<h3 id="_different_representations">Different representations</h3>
<div class="paragraph">
<p>Try out different representation modes with the show option (S), the Presets&#8230;&#8203; tab or command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Show of model_0 -&gt; ribbon, cartoon, sticks, spheres or surface
# Hide of model_0 -&gt; ribbon, cartoon, sticks, spheres or surface <i class="conum" data-value="1"></i><b>(1)</b>
&gt;
show ribbon, model_0
show cartoon, model_0
show sticks, model_0
show spheres, model_0
show surface, model_0
hide ribbon, model_0 <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Different representations: ribbon, cartoon, sticks, spheres, and surface</div>
<p><span class="image"><img src="Figures/Figure4.png" alt="Figure4"></span></p>
</div>
<div class="paragraph">
<p>Most common representations are cartoon, where alpha helices and beta sheets can be easily identified; sticks, where the lateral chains are showed; and surface, which shows the solvent accessible surface, making pockets easily recognizable.</p>
</div>
<div class="paragraph">
<p>Take a closer look to compare the sticks and the ribbon representation. Can you identify what each line of the ribbon represents?</p>
</div>
</div>
<div class="sect2">
<h3 id="_coloring_and_apbs">Coloring and APBS</h3>
<div class="paragraph">
<p>There are also different coloring modes which facilitate the identification of different features.
Try with the sticks representation, coloring by element, and see if you can differentiate some main chain atoms from side chain atoms.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Show of model_0 -&gt; sticks
# Color of model_0 -&gt; by element -&gt; any option
# Hide of model_0 -&gt; hydrogens -&gt; all <i class="conum" data-value="1"></i><b>(1)</b>
&gt;
show sticks, model_0
color atomic, (not elem C)
hide (hydro)</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Hide the hydrogens to make it easier.
PyMOL follows the <a href="https://en.wikipedia.org/wiki/CPK_coloring">CPK colour convention</a>.
Except for carbons.
In CPK, nitrogen is blue, oxygen is red and phosphorus is orange, for example.</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure5.png" alt="Figure5" width="300">
</div>
</div>
<div class="paragraph">
<p>In the cartoon mode, useful color modes are spectrum rainbow, coloring by residue number, and the coloring by secondary structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Color of model_0 -&gt; spectrum -&gt; rainbow
# Color of model_0 -&gt; by ss -&gt; first option
</span><span class="o">&gt;</span>
<span class="n">color</span> <span class="n">red</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">h</span>
<span class="n">color</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">color</span> <span class="n">green</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">l</span><span class="o">+</span><span class="sh">''</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Different coloring modes: spectrum rainbow and by ss</div>
<p><span class="image"><img src="Figures/Figure6.png" alt="Figure6" width="500"></span></p>
</div>
<div class="paragraph">
<p>Another very useful coloring mode is by atomic displacement, also referred as temperature factor, or B factor, in crystallography.
This parameter reflects the flexibility of each residue and is stored in a column after the coordinates in the .cif or .pdb files.
In AlphaFold predictions, this column stores the confidence or the pLDTT value for each residue or atom.</p>
</div>
<div class="paragraph">
<p>We can color it to show AlphaFold&#8217;s confidence for each residue.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Color of model_0 -&gt; spectrum -&gt; b-factors <i class="conum" data-value="1"></i><b>(1)</b>
&gt;
set_color n0, [0.051, 0.341, 0.827] <i class="conum" data-value="2"></i><b>(2)</b>
set_color n1, [0.416, 0.796, 0.945]
set_color n2, [0.996, 0.851, 0.212]
set_color n3, [0.992, 0.490, 0.302]
color n0, b &lt; 100
color n1, b &lt; 90
color n2, b &lt; 70
color n3, b &lt; 50</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Colouring by mouse command only has limited options for colouring</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>But by command line we can set the same colours as in AlphaFold&#8217;s standard representation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Predicted MATE colored by plDDT</div>
<p><span class="image"><img src="Figures/Figure7.png" alt="Figure7" width="300"></span></p>
</div>
<div class="paragraph">
<p>In the surface mode, it is also common to color by charge distribution. This requires some calculation, since charges redistribute themselves at the surface in the presence of a solvent.
The eletrostatic potential of a molecule can be calculated in PyMOL with the APBS plugin.
APBS stands for Adaptative Poisson-Boltzmann Solver.
It&#8217;s a program to numerically solve the rearrangement of charges of a molecule surrounded by a solvent with ions and dielectric properties.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure8.jpg" alt="Figure8">
</div>
<div class="title">Figure 1. Redistribution of charges of the solid in response to the charges of the solvent [source: <a href="https://en.wikipedia.org/wiki/Poisson%E2%80%93Boltzmann_equation">wikipedia</a>].</div>
</div>
<div class="paragraph">
<p>Let&#8217;s calculate the distribution of the electrostatic potential at the surface of our MATE.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; model_0 -&gt; Yes
</span><span class="o">&gt;</span>
<span class="kn">from</span> <span class="n">pmg_tk.startup.apbs_gui.creating</span> <span class="kn">import</span> <span class="n">pdb2pqr_cli</span>
<span class="kn">from</span> <span class="n">pmg_tk.startup.apbs_gui.electrostatics</span> <span class="kn">import</span> <span class="n">map_new_apbs</span>
<span class="nf">pdb2pqr_cli</span><span class="p">(</span><span class="sh">"</span><span class="s">prepared01</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">model_0</span><span class="sh">"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">--ff</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">amber</span><span class="sh">"</span><span class="p">])</span>
<span class="nf">map_new_apbs</span><span class="p">(</span><span class="sh">"</span><span class="s">apbs_map01</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">prepared01</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">apbs_map01</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared01</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You might need administrator permission to run this depending how PyMOL was installed.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure8.png" alt="Figure8" width="300">
</div>
</div>
<div class="paragraph">
<p>See how the sides of the protein are whiter, which should be surrounded by hydrophobic membrane, and how the channel pore is very negatively charged, this should direct the way of a small ligand through the pore.
This analysis helps us identify sites of interaction and which type of interaction it is.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_first_selections">First selections</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is very important to be able to analyse specific residues or regions of the protein. PyMOL provides many selections options.
It is easy to select residues by their name, for example. See if you can find all the prolines in MATE.
Note that all prolines are in loop regions, or at the ends of alpha helices, or close to a region of the alpha helix that is bending.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Enable SEQ
# Click on all P residues
# Action of (sele) -&gt; rename selection -&gt; allpros <i class="conum" data-value="1"></i><b>(1)</b>
# Show of (allpros) -&gt; sticks
# Color of (allpros) -&gt; by element -&gt; first option
# Hide of (allpros) -&gt; hydrogens -&gt; all
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">allpros</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">resname</span> <span class="n">PRO</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">allpros</span>
<span class="n">color</span> <span class="n">atomic</span><span class="p">,</span> <span class="p">(</span><span class="n">allpros</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">elem</span> <span class="n">C</span><span class="p">)</span>
<span class="nf">hide </span><span class="p">(</span><span class="n">allpros</span> <span class="ow">and</span> <span class="n">hydro</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If your PyMOL version does not allow you to rename a selection, try using the command line: &gt;set_name sele, allpros</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure9.png" alt="Figure9" width="300">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ramachandran">Ramachandran</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Prolines are special amino acids because of their circular side chain, which constraints its phi and psi angles.
We can check that the prolines, and other amino acids, were predicted with possible phi and psi angles in a Ramachandran plot.
To plot it we are going to use a plugin, a python script, <a href="https://pymolwiki.org/index.php/DynoPlot">dynoplot.py</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Plugin -&gt; Plugin Manager -&gt; Install New Plugin -&gt; Choose file... -&gt; choose dynoplot.py in the folder you created.
# Plugin -&gt; Rama Plot
</span><span class="o">&gt;</span>
<span class="n">pwd</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="n">run</span> <span class="n">dynoplot</span><span class="p">.</span><span class="n">py</span>
<span class="n">ramachandran</span> <span class="n">model_0</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make sure you are in the correct folder, where dynoplot.py is</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Unfortunately, running the functions inside plugins can only be done with command line.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A simple, but interactive, window will appear. The colors of the dots follow the colors of the object in the main window.
And the shape of the dots, indicate glycines (triangles), prolines (squares), and all others (circles).
Try clicking on each dot, with the right button of mouse to select and center on the respective residue in the main window.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure10.png" alt="Figure10" width="300">
</div>
</div>
<div class="paragraph">
<p>This Ramachandran plot can also be done for selections. Try plotting only prolines. Do they fall in the allowed regions?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">ramachandran</span> <span class="n">allpros</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Plugins, or python scripts, are one of the best options for more advanced or particular analyses.
<a href="https://pymolwiki.org/index.php/Plugins">Here</a>  is more information about them. You can also find many other examples in the <a href="https://wiki.pymol.org/index.php/Category:Script_Library">PyMOL wiki library</a>, or even make your own!
To make a nice figure for the entire protein, with energy counter lines, try running the script ramachandran.py in the folder of this course.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contact_matrix">Contact matrix</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The contact matrix is another common plot for protein analyses.
It shows which residues are close in space, defined by a threshold, and the patterns that appear indicate the secondary structure.
Thick lines indicate alpha helices, parallel lines indicate parallel helices or strands, and perpendicular lines indicate antiparallel helices or strands.</p>
</div>
<div class="paragraph">
<p>To plot the contact matrix we will use another python script.
This script uses matplotlib to draw the plot, so maybe you need to install it first (like installing a python library to run a python script). This can be done in the command line of PyMOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="n">conda</span> <span class="n">install</span> <span class="n">matplotlib</span> <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Alternatively, pip install matplotlib</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Next commands are only possible via command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">pwd</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="n">run</span> <span class="n">pymol_cm</span><span class="p">.</span><span class="n">py</span>
<span class="nf">plot_contact_map</span><span class="p">(</span><span class="sh">'</span><span class="s">model_0</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">model_0</span><span class="sh">'</span><span class="p">,</span><span class="n">max_dist</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make sure you are in the correct folder, where dynoplot.py is</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>plot_contact_map is a function of the pymol_cm.py script. It requires three input parameters in the parentheses: the two objects or selections whose residues are going to be probed for distance in between, and max_dist, a maximum distance between the residues to appear in the contact matrix.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The output figure is saved in the current folder as contact_map.png.
Try to identify where helices start and end, and in which direction they interact with other helices.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure11.png" alt="Figure11" width="300">
</div>
</div>
<div class="paragraph">
<p>This is also a nice tool to find contacts between different regions of the protein or between different protein chains.</p>
</div>
<div class="paragraph">
<p>The MATE proteins have a pseudo symmetry, with two domains facing each other around the axis, which follows the channel pore.
Each domain has six alpha helices.
Try to identify the domains and make two selections, one for each domain, with different colors.
Make sure the view options displays "Residues".</p>
</div>
<div class="paragraph">
<p>Next, find close contacts residues between the two domains.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">domain1_interface</span><span class="p">,</span> <span class="n">byres</span> <span class="n">domain1</span> <span class="n">within</span> <span class="mi">5</span> <span class="n">of</span> <span class="n">domain2</span>
<span class="n">select</span> <span class="n">domain2_interface</span><span class="p">,</span> <span class="n">byres</span> <span class="n">domain2</span> <span class="n">within</span> <span class="mi">5</span> <span class="n">of</span> <span class="n">domain1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, plot the contact matrices between these two domains.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">pwd</span>
<span class="n">run</span> <span class="n">pymol_cm</span><span class="p">.</span><span class="n">py</span>
<span class="nf">plot_contact_map</span><span class="p">(</span><span class="sh">'</span><span class="s">domain1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">domain2</span><span class="sh">'</span><span class="p">,</span><span class="n">max_dist</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Are the contacts appearing in the contact map consistent with the list of interface residues?</p>
</div>
<details>
<summary class="title">Answer to this exercise</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Enable SEQ
# Select residues form 93 to 320
# Action of (sele) -&gt; rename selection -&gt; domain1 <i class="conum" data-value="1"></i><b>(1)</b>
# Select residues form 329 to 534
# Color of (domain1) -&gt; choose a color
# Action of (sele) -&gt; rename selection -&gt; domain2 <i class="conum" data-value="1"></i><b>(1)</b>
# Color of (domain2) -&gt; choose a color
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">domain1</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">93</span><span class="o">-</span><span class="mi">320</span>
<span class="n">color</span> <span class="n">marine</span><span class="p">,</span> <span class="p">(</span><span class="n">domain1</span><span class="p">)</span>
<span class="n">select</span> <span class="n">domain2</span><span class="p">,</span> <span class="n">model_0</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">329</span><span class="o">-</span><span class="mi">534</span>
<span class="n">color</span> <span class="n">brightorange</span><span class="p">,</span> <span class="p">(</span><span class="n">domain2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure12.png" alt="Figure12" width="500">
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_structural_superposition">Structural superposition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is important to be able to compare different structures.
Many other members of the MATE family, from other organisms as well, have their structures experimentally solved. Some of them with different ligands bound to it. Let us try to see if one of those ligands could fit in the channel of our MATE example.</p>
</div>
<div class="paragraph">
<p>Another way to upload a structure is by online fetching.
This feature automatically searches for a .cif file in the online <a href="https://www.rcsb.org/">Protein Data Bank</a> with the given PDB code.
Fetch a MATE structure from <em>Pyrococcus furious</em> in complex with a small peptide, PDB code 3vvr.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Get PDB... -&gt; 3vvr
# Hide of 3vvr -&gt; water
</span><span class="o">&gt;</span>
<span class="n">fetch</span> <span class="mi">3</span><span class="n">vvr</span>
<span class="n">hide</span> <span class="n">everything</span><span class="p">,</span> <span class="n">solvent</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you should have 2 objects displayed at your sidebar.
A click at the name of an object will disable or enable it.</p>
</div>
<div class="paragraph">
<p>To compare their structural variability more easily, we should superpose them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 3vvr -&gt; align -&gt; to molecule -&gt; model_0
# Action of model_0 -&gt; center
</span><span class="o">&gt;</span>
<span class="n">align</span> <span class="mi">3</span><span class="n">vvr</span><span class="p">,</span> <span class="n">model_0</span>
<span class="n">center</span> <span class="mi">3</span><span class="n">vvr</span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Structural alignment or superposition</div>
<p><span class="image"><img src="Figures/Figure13.png" alt="Figure13" width="400"></span></p>
</div>
<div class="paragraph">
<p>The <a href="https://pymolwiki.org/index.php/Align">align command</a> first performs a sequence alignment and then minimizes the Root Mean Square Deviation of the aligned residues. <a href="https://pymolwiki.org/index.php/Super">Super</a> is another superposition tool available in PyMOL. It does not perform a sequence alignment first, but iteratively searches for lowest RMSD, so prefer it over the align command if the structures have low identity.
Both of them perform global alignments, but sometimes the proteins have similar structural domains that are relatively displaced, so it is more useful to just superpose a each domain at a time. For this use the same commands but with a pre-made selection.</p>
</div>
<div class="paragraph">
<p>Now let us see if the peptide of 3vvr could fit in the channel pore of our MATE.
First copy the peptide to a new object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># With selection mode 'Chains' select the peptide
# Action of (sele) -&gt; copy to object -&gt; new
</span><span class="o">&gt;</span>
<span class="n">create</span> <span class="n">peptide</span><span class="p">,</span> <span class="mi">3</span><span class="n">vvr</span> <span class="ow">and</span> <span class="n">chain</span> <span class="n">B</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>One strategy is simply to show the surface of our MATE example and see if the peptide could fit in the channel pore, without passing through the surface of the pore!
Another strategy is to draw residues close to the peptide in sticks and check if they clash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Show of model_0 -&gt; surface
# With selection mode 'Chains' select the peptide
# Action of (sele) -&gt; modify -&gt; around -&gt; residues within 2 A <i class="conum" data-value="1"></i><b>(1)</b>
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to around_peptide
# Show of (around_peptide) -&gt; sticks
# Disable (around_peptide)
# Setting -&gt; Transparency -&gt; Surface -&gt; 60%
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">around_peptide</span><span class="p">,</span> <span class="n">byres</span> <span class="n">model_0</span> <span class="n">within</span> <span class="mi">2</span> <span class="n">of</span> <span class="n">peptide</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">around_peptide</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">model_0</span>
<span class="nb">set</span> <span class="n">transparency</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">model_0</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Most van der Waals radii sums are &gt;3.0 Å. If heavy atoms are closer than 2.0 Å, it&#8217;s a strong clash.
Can you see clashes?</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/Figure14.png" alt="Figure14" width="400"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rendering_a_figure">Rendering a figure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, PyMOL allows you to explore your artistic skills and render a clear and appealing figure for publication.
In this example, we focus on the peptide inside the channel pore.
See if you can reproduce this image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Figures/Figure15.png" alt="Figure15" width="500">
</div>
</div>
<details>
<summary class="title">Answer to this exercise</summary>
<div class="content">
<div class="paragraph">
<p>First, choose a position where the main characters are centralized.
Choose colors that highlight the main characters, and prefer to show only the necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">color</span> <span class="n">white</span><span class="p">,</span> <span class="n">model_0</span>
<span class="n">color</span> <span class="n">atomic</span><span class="p">,</span> <span class="p">(</span><span class="n">around_peptide</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">elem</span> <span class="n">C</span><span class="p">)</span>
<span class="n">color</span> <span class="n">gray50</span><span class="p">,</span> <span class="n">domain2</span>
<span class="nb">set</span> <span class="n">cartoon_cylindrical_helices</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">show</span> <span class="n">cartoon</span><span class="p">,</span> <span class="n">model_0</span>

<span class="n">hide</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="n">select</span> <span class="n">apbsaround_peptide</span><span class="p">,</span> <span class="n">byres</span> <span class="n">prepared01</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="n">peptide</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">apbsaround_peptide</span>
<span class="n">hide</span> <span class="n">cartoon</span><span class="p">,</span> <span class="n">peptide</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">peptide</span>
<span class="n">color</span> <span class="n">brightorange</span><span class="p">,</span> <span class="n">peptide</span>
<span class="n">dist</span> <span class="n">clashes</span><span class="p">,</span> <span class="n">peptide</span><span class="p">,</span> <span class="n">around_peptide</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">2</span>
<span class="nb">set</span> <span class="n">dash_color</span><span class="p">,</span> <span class="n">black</span><span class="p">,</span> <span class="n">clashes</span>
<span class="n">hide</span> <span class="n">label</span><span class="p">,</span> <span class="n">clashes</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now make the background white and use transparency effects to highlight only main objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Display -&gt; Background -&gt; White
# Setting -&gt; Transparency -&gt; Surface -&gt; 50%
# Setting -&gt; Transparency -&gt; Cartoon -&gt; 20% <i class="conum" data-value="1"></i><b>(1)</b>
</span><span class="o">&gt;</span>
<span class="n">bg_color</span> <span class="n">white</span>
<span class="nb">set</span> <span class="n">transparency</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="nb">set</span> <span class="n">cartoon_transparency</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">model_0</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>With mouse commands, the transparency effect can only be applied to types of representation (surface, cartoon, sticks &#8230;&#8203;).
But with command line, the transparency can be applied to different objects.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, PyMOL has a <a href="https://pymolwiki.org/index.php/Ray">ray</a> option to render images with better quality.
You save different figures with different ray trace modes and then superpose them. But here we will use only mode 1.
Hide also light effects for a clearer image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Setting -&gt; Rendering -&gt; Shadows -&gt; None
# Display -&gt; Specular reflections (untick)
# Setting -&gt; Edit All... -&gt; ray_trace_mode set to 1
# Draw/Ray -&gt; Ray(Slow) -&gt; Save picture to file -&gt; img.png
</span><span class="o">&gt;</span>
<span class="nb">set</span> <span class="n">ray_shadows</span><span class="p">,</span> <span class="mi">0</span>
<span class="nb">set</span> <span class="n">specular</span><span class="p">,</span> <span class="n">off</span>
<span class="nb">set</span> <span class="n">ray_trace_mode</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">Ray</span>
<span class="n">png</span> <span class="n">img</span><span class="p">.</span><span class="n">png</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use your favorite program to further edit the image together and add labels.</p>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_save">Save</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last, do not forget to save your work!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Save Session As...
</span><span class="o">&gt;</span>
<span class="n">pwd</span>
<span class="n">save</span> <span class="n">session</span><span class="p">.</span><span class="n">pse</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fun_exercises">Fun exercises</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_identify_anfinsens_cysteines">Identify Anfinsen&#8217;s cysteines</h3>
<div class="paragraph">
<p>In his classic experiment, Anfinsen used a bovine pancreatic ribonuclease A, PDB code 1fs3. Can you identify the 8 cysteines and what are the correct pairs?</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_the_surface_charge_distribution_of_a_single_alpha_helix">Check the surface charge distribution of a single alpha helix</h3>
<div class="paragraph">
<p>Alpha helices have a net of hydrogen bonds between the main chain atoms. Pointing at similar directions they sum up to an electric dipole of the helix. Create a new object from a selection of a helix stretch and use the command distance or find polar contacts to display the hydrogen bonds forming the helix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of helix_object -&gt; find -&gt; polar contacts -&gt; within selection
</span><span class="o">&gt;</span>
<span class="n">dist</span> <span class="n">Hbonds</span><span class="p">,</span> <span class="n">helix_object</span><span class="p">,</span> <span class="n">helix_object</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In which terminals of the helix are the positive and the negative charges?</p>
</div>
</div>
<div class="sect2">
<h3 id="_try_different_phi_and_psi_angles">Try different phi and psi angles</h3>
<div class="paragraph">
<p>The dynoplot.py plugin allows editing phi and psi angles if you click on one dot of the plot with the left button of the mouse. Create a new object from a selection of four connected amino acids, make the Ramachandran plot, and move around one of the dots on the plot to see how this changes the structure. See if you can identify clashing angles. Hint: to update the view in PyMOL faster, use the rock option of the camera.</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_models_1_4">Check models 1-4</h3>
<div class="paragraph">
<p>AlphaFold&#8217;s prediction is partially stochastic. Every run generates different models and the 5 output models per run are a small sampling from that. Open all the predicted models in PyMOL and check how different they are. Particularly, are the differences related to the pLDTTs?</p>
</div>
</div>
<div class="sect2">
<h3 id="_predict_another_mate_example">Predict another MATE example</h3>
<div class="paragraph">
<p>There close to 50 proteins of the MATE family in barley. Though it is not yet clear how all of them differ in function, we could find a MATE member that is predicted in a very different conformation compared to our example. Predict it too and try to hypothesize about their different functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span><span class="n">MATE_example2</span>
<span class="n">MDLPTVFFHGATLAFQRDDLGKEIMGIAVPGALALMADPLASLVDTAFIGHIGPVELAAVGVSIVVFNQV</span>
<span class="n">TRIAVFPLVSVTTSFVAEEDATSSDRHKDEISGDNENNVSEMDELISHEETSGKSSFETGSSEINIEHTR</span>
<span class="n">KKIPSVSTALLLGGVLGLFETLLLVSCAKPILDFMGVKADTGMLKPALQYLVLRSLGAPAVLLSLAMQGV</span>
<span class="n">FRGLKDTRTPLYATVVGDAINIVLDPIFMFVFQYGVSGAAVAHVISQYFIAAILLCRLRLQVELLPPNLK</span>
<span class="n">HLPIGRFLKNGSLLLARVIAATCCVTLSASMAARLGSTQMAAFQICLQIWLASSLLADGLAFAGQAILAS</span>
<span class="n">AFARKDHSKAKATASRILQLGLILGLLLSLLLGVGLHTGSRLFTEDKGVLHHIYVATPFVALTQPINALA</span>
<span class="n">FVFDGVNYGASDFAYAAYSLILVAIVSIACIVTLASYSGFVGIWIALSIYMCLRMFAGLWRIGTARGPWV</span>
<span class="n">FLRS</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_find_local_regions_with_optimal_superposition">Find local regions with optimal superposition</h3>
<div class="paragraph">
<p>Our group is developing an algorithm that finds local regions that superpose best. This can be a useful tool to analyze relatively flexible domains.
As we are still developing it, there are some shortcomes, for example, it only accepts objects of AlphaFold predictions, with plddt values.
If you are brave enough to try it, see if it can help you understand the conformational differences between the two examples of MATE.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">run</span> <span class="n">pymolAlign_lddt_sw2</span><span class="p">.</span><span class="n">py</span>
<span class="nf">super_lddt</span><span class="p">(</span><span class="n">pdbs</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">mate1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">mate2</span><span class="sh">'</span><span class="p">],</span><span class="n">min_score</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-05-14 11:19:16 +0200
</div>
</div>
</body>
</html>